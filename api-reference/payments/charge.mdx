---
title: "Charge Payment"
description: "Pay for a delivery or bulk deliveries from your wallet"
---

## Overview

Process payment for a delivery (or all deliveries in a bulk) from your wallet balance. This endpoint supports idempotency through the `reference` parameter.

<Note>
  **Required permission:** `payment:create`
</Note>

## Endpoint

```
POST /api/payments/charge
```

## Request

### Headers

<ParamField header="X-API-Key" type="string" required>
  Your Chidori API key
</ParamField>

<ParamField header="Content-Type" type="string" required>
  Must be `application/json`
</ParamField>

### Body parameters

<ParamField body="deliveryId" type="string" required>
  The delivery ID to pay for. If this delivery belongs to a bulk, all deliveries in the bulk will be paid.
</ParamField>

<ParamField body="reference" type="string" required>
  Client-generated idempotency key. Re-using the same reference will not double-charge.
</ParamField>

<ParamField body="amount" type="number">
  Optional amount verification. If provided, must match the computed delivery amount.
</ParamField>

## Response

### Success response

<ResponseField name="status" type="boolean">
  Always `true` for successful requests
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="properties">
    <ResponseField name="deliveryId" type="string">
      The delivery ID that was paid
    </ResponseField>
    <ResponseField name="bulk" type="string">
      Bulk ID if this was a bulk payment (null for single deliveries)
    </ResponseField>
    <ResponseField name="amount" type="number">
      Total amount charged in Naira
    </ResponseField>
    <ResponseField name="paymentChannel" type="string">
      Payment method used (e.g., "Wallet")
    </ResponseField>
    <ResponseField name="reference" type="string">
      Your idempotency reference
    </ResponseField>
  </Expandable>
</ResponseField>

## Examples

### Single delivery payment

<RequestExample>
```bash cURL
curl -X POST https://api.chidori.africa/api/payments/charge \
  -H "X-API-Key: sk_live_xxx.yyy" \
  -H "Content-Type: application/json" \
  -d '{
    "deliveryId": "abc123-def456-ghi789",
    "reference": "order_12345_payment"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.chidori.africa/api/payments/charge', {
  method: 'POST',
  headers: {
    'X-API-Key': 'sk_live_xxx.yyy',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    deliveryId: 'abc123-def456-ghi789',
    reference: 'order_12345_payment'
  })
});

const data = await response.json();
```

```python Python
import requests

response = requests.post(
    'https://api.chidori.africa/api/payments/charge',
    headers={
        'X-API-Key': 'sk_live_xxx.yyy',
        'Content-Type': 'application/json'
    },
    json={
        'deliveryId': 'abc123-def456-ghi789',
        'reference': 'order_12345_payment'
    }
)

data = response.json()
```
</RequestExample>

<ResponseExample>
```json 200 Success (Single)
{
  "status": true,
  "data": {
    "deliveryId": "abc123-def456-ghi789",
    "bulk": null,
    "amount": 2500,
    "paymentChannel": "Wallet",
    "reference": "order_12345_payment"
  }
}
```

```json 200 Success (Bulk)
{
  "status": true,
  "data": {
    "deliveryId": "abc123-def456-ghi789",
    "bulk": "1a4f1a5e-5b79-4c4a-a0d4-4c5c7b7bb1aa",
    "amount": 7500,
    "paymentChannel": "Wallet",
    "reference": "bulk_order_payment"
  }
}
```

```json 402 Insufficient Balance
{
  "status": false,
  "message": "Insufficient wallet balance"
}
```

```json 404 Not Found
{
  "status": false,
  "message": "Delivery not found"
}
```
</ResponseExample>

## Bulk payment behavior

When you pay for a delivery that belongs to a bulk:

1. The system identifies the bulk ID from the delivery
2. Calculates the total amount for **all unpaid deliveries** in that bulk
3. Charges the full bulk total from your wallet
4. Marks all deliveries in the bulk as paid

<Info>
  You can pass **any** `deliveryId` from the bulkâ€”the system will find and charge the entire bulk.
</Info>

## Idempotency

The `reference` parameter ensures safe retries:

- If a request fails due to network issues, you can safely retry with the same reference
- If the original request succeeded, the retry will return the same response without double-charging
- Use unique references for each distinct payment (e.g., include your order ID)

```javascript
// Good: Unique reference per order
const reference = `order_${orderId}_delivery_payment`;

// Bad: Reusing references across different orders
const reference = 'payment'; // Don't do this!
```

## Error handling

| Status | Message | Action |
|--------|---------|--------|
| `400` | Validation error | Check request parameters |
| `401` | Unauthorized | Verify API key |
| `402` | Insufficient wallet balance | Add funds to wallet |
| `403` | Forbidden | Check API key permissions |
| `404` | Delivery not found | Verify delivery ID |

## Wallet management

<Warning>
  Ensure your wallet has sufficient balance before attempting payment. Fund your wallet through the [Chidori Dashboard](https://chidori.africa/dashboard).
</Warning>

## Next steps

<CardGroup cols={2}>
  <Card title="List Transactions" icon="list" href="/api-reference/payments/list-transactions">
    View your payment history
  </Card>
  <Card title="Get Delivery" icon="truck" href="/api-reference/deliveries/get">
    Check delivery status after payment
  </Card>
</CardGroup>
